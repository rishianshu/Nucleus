2025-12-13T19:53:14Z | start | done: booted code-vector-profile-and-indexing-v1 run, confirmed intent/spec/acceptance files exist | next: read INTENT/SPEC/ACCEPTANCE plus PLAN/TODO/LOG tail for resume context | risks: none yet
2025-12-13T20:33:59Z | heartbeat | done: added vector_documents schema/store and seeded code.github.v1 profile; built code index runner with ingestionRunId filtering, deterministic embeddings, and MinIO JSONL.GZ normalization; added AC1â€“AC4 tests and reran pnpm --filter @apps/metadata-api test:brain (fails: METADATA_DATABASE_URL missing) | next: apply the new migration, configure METADATA_DATABASE_URL/pgvector Postgres, rerun brain tests, and validate index-run output against acceptance | risks: Postgres/pgvector env absent and migrations not yet applied; test suite blocked until METADATA_DATABASE_URL is set
2025-12-14T05:07:40Z | heartbeat | done: consolidated code/doc/work onto vector_index_entries (doc_id + metadata), removed vector_documents; added in-memory profile/vector stores for offline tests; fixed code index runner to use upsertEntries and reran pnpm --filter @apps/metadata-api test:brain (all green with deterministic embeddings) | next: apply migration 20251213195500_code_vector_documents to pgvector DB, hook production embedding provider, and run db-backed validation when infra is available | risks: prod DB not yet migrated; embeddings still use fake provider in tests only
2025-12-14T05:27:43Z | heartbeat | done: ran prisma migrate deploy with METADATA_DATABASE_URL (schema metadata @ localhost:5434) and applied 20251213195500_code_vector_documents | next: validate code indexer against real MinIO + production embeddings, then update TODO/state once prod DBs are migrated | risks: none locally; prod envs still need migration + real embedding provider
2025-12-14T06:17:45Z | heartbeat | done: ingested public repo (octocat/Hello-World) via real GitHub connector into MinIO localhost:9000 (ucl-staging) and ran CodeIndexRunner against sink raw.code.file_chunk using deterministic embeddings; vectors landed in metadata.vector_index_entries (docId/code profile) | next: rerun indexing with production embedding provider when available; keep MinIO artifacts for reuse | risks: current vectors use deterministic embeddings, not production model
2025-12-14T07:02:10Z | heartbeat | done: added materialized_artifacts registry + Prisma registry client; CodeIndexRunner now records run status (IN_PROGRESS/SUCCEEDED/FAILED) into registry (default no-op), fixed pg upsert placeholder, migrations applied and test:brain still green | next: wire ingestion sink completion to create registry entries and run indexer with production embeddings | risks: registry not yet fed by ingestion pipeline; embeddings still deterministic in local runs
2025-12-22T18:55:00Z | handoff | done: Implemented endpoint-driven vector normalization (ucl-core: VectorProfileProvider, GitHub connector, staging); brain-core: IndexArtifact reads pre-normalized vectorPayload. Verified staging contains valid vectorPayload. | next: DEBUG why vector_entries remains empty despite IndexArtifact running (logs: checkpoint-save-failed/deadline exceeded). | risks: persistent timeout or silent failure in brain block db persistence.
2025-12-22T13:23:29Z | resume | done: resumed code-vector-profile-and-indexing-v1 run; reviewed INTENT/SPEC/ACCEPTANCE, PLAN, TODO, LOG tail | next: investigate IndexArtifact pipeline/vector_entries empty issue; inspect code + logs and run targeted brain tests | risks: db persistence path or long-running checkpoint failures could block indexing
2025-12-22T14:06:27Z | heartbeat | done: propagated vectorPayload/rawPayload through staging iterator, normalized nested payload fallback, hardened KV gRPC default to 9099, and added Go tests (streamFromStaging, normalization); GOCACHE=/tmp/go-cache go test ./internal/activities passed | next: update TODO/STATE/story, then validate indexing on real env when available | risks: production indexing still unverified against live store-core/minio stack
